# BharatPay UPI订阅对接文档

1. 概述

   ### 1.1 目的
      本文档提供BharatPay支付系统接口文档说明， 旨在规范、快速的帮助合作伙伴们完成支付的对接。

   ### 1.2 适用范围
      需要对接BharatPay UPI订阅支付的商户可参考此文档

   ### 1.3 请求域名
      UPI订阅相关api的请求域名为: mandate.bharatpay.me

   ### 1.4 接口描述

      文档的主要接口包括：

         1. UPI订阅支付的订阅计划创建

         2. 订阅计划详情查询

         3. 预发送扣款通知(执行扣款前24小时一定要调用该接口)
   
         4. 触发扣款执行
   
         5. 订阅计划状态查询

         6. 订阅计划的修改

         7. 预发送扣款通知状态查询

         8. 获取可用的订阅计划(套餐)列表

         9. 订阅计划相关的回调动作

   ### 1.5 其他说明
   1. 目前订阅计划创建之后，可以对当前订阅计划进行暂停或撤销操作。其中暂停操作仅支持用户测操作(在授权付款app中进行)，撤销操作用户和商户均可进行(用户在授权付款app中进行，商户则需要调用订阅计划修改的api来修改订阅计划的状态为撤销).

   2. 创建订阅计划时，需要上传首次扣款金额，执行扣款金额和最大扣款金额，首次扣款金额为用户授权后的首次扣款金额，首次扣款不需要调用 触发扣款执行api，用户授权后会即刻执行扣款操作。第二次以及后续的扣款操作，每次需要在执行扣款前24小时调用 预发送扣款通知api，通知之后24小时调用 触发扣款执行api 即可执行扣款操作，扣款结果会通过回调的方式给到商户。

   3. 第二次以及后续扣款时，扣款金额可以发生变化，扣款金额只需小于创建订阅计划时的最大扣款金额即可。商户可以利用此机制来适配后续扣款金额可能发生变化的场景。
